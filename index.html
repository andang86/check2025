<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>온열질환 예방조치 점검표 제출</title>
    <style>
        /* 이전과 유사한 스타일 */
        body { font-family: sans-serif; margin: 20px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ddd; padding: 8px; }
        th { background-color: #f2f2f2; }
        .input-group { margin-bottom: 20px; }
        .input-group label { font-weight: bold; margin-right: 10px; }
        .input-group input[type="text"] { padding: 8px; border: 1px solid #ccc; border-radius: 4px; }
        button { padding: 10px 20px; background-color: #28a745; color: white; border: none; border-radius: 4px; cursor: pointer; }
        #message { margin-top: 15px; font-weight: bold; }
    </style>
</head>
<body>
    <h1>온열질환 예방조치 이행실태 점검표</h1>

    <div class="input-group">
        <label for="chapterName">지회명:</label>
        <input type="text" id="chapterName" name="chapterName" placeholder="지회명을 입력하세요" required>
    </div>

    <table id="checklistTable">
        <thead>
             <tr><th>점검 항목</th><th>세부내용</th><th>점검 결과</th></tr>
        </thead>
        <tbody>
            <tr>
                <td>1. 폭염시 작업중지</td>
                <td>폭염으로 급박한 위험 발생 시 사업주 작업중지</td>
                <td>
                    <label><input type="radio" name="check1_1" value="예"> 예</label>
                    <label><input type="radio" name="check1_1" value="아니요"> 아니요</label>
                </td>
            </tr>
            </tbody>
    </table>

    <button id="submitBtn">제출하기</button>
    <div id="message"></div>

    <script>
        document.getElementById('submitBtn').addEventListener('click', async () => {
            const chapterName = document.getElementById('chapterName').value;
            if (!chapterName) {
                alert('지회명을 입력해주세요!');
                return;
            }

            const checklistData = {};
            document.querySelectorAll('#checklistTable input[type="radio"]:checked').forEach(radio => {
                checklistData[radio.name] = radio.value;
            });

            const submissionData = { chapterName, checklistData };
            const messageDiv = document.getElementById('message');
            messageDiv.textContent = '제출 중...';

            try {
                const response = await fetch('/api/submit', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(submissionData),
                });
                if (response.ok) {
                    messageDiv.textContent = '성공적으로 제출되었습니다!';
                    messageDiv.style.color = 'green';
                } else {
                    throw new Error('서버 오류');
                }
            } catch (error) {
                messageDiv.textContent = '제출에 실패했습니다.';
                messageDiv.style.color = 'red';
            }
        });
    </script>
</body>
</html>
